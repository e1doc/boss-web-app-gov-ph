{"remainingRequest":"/var/www/html/boss-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/var/www/html/boss-web/src/components/payment/PaymentDetailsModal.vue?vue&type=script&lang=js&","dependencies":[{"path":"/var/www/html/boss-web/src/components/payment/PaymentDetailsModal.vue","mtime":1612455150458},{"path":"/var/www/html/boss-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/var/www/html/boss-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/var/www/html/boss-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/var/www/html/boss-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBCYXNlSW5wdXQgZnJvbSAiQC9jb21wb25lbnRzL2Zvcm1zL0Jhc2VJbnB1dCI7CmltcG9ydCBCYXNlRGF0ZVBpY2tlciBmcm9tICJAL2NvbXBvbmVudHMvZm9ybXMvQmFzZURhdGVQaWNrZXIiOwppbXBvcnQgQmFzZUZpbGVVcGxvYWRlciBmcm9tICJAL2NvbXBvbmVudHMvZm9ybXMvQmFzZUZpbGVVcGxvYWRlciI7CmltcG9ydCBCdXR0b25CbG9jayBmcm9tICJAL2NvbXBvbmVudHMvQnV0dG9uQmxvY2siOwppbXBvcnQgeyBtYXBHZXR0ZXJzIH0gZnJvbSAidnVleCI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiUGF5bWVudERldGFpbHNNb2RhbCIsCiAgY29tcG9uZW50czogewogICAgQmFzZUlucHV0LAogICAgQmFzZURhdGVQaWNrZXIsCiAgICBCYXNlRmlsZVVwbG9hZGVyLAogICAgQnV0dG9uQmxvY2ssCiAgfSwKICBjb21wdXRlZDogewogICAgLi4ubWFwR2V0dGVycyhbCiAgICAgICJwYXltZW50RGV0YWlscyIsCiAgICAgICJjdXJyZW50U29hT2JqIiwKICAgICAgInN0ZXBPbmVFcnJvcnMiLAogICAgICAiaXNGaWxlVXBsb2FkZWQiLAogICAgXSksCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgcGF5bWVudF9kZXRhaWxzOiB7CiAgICAgICAgYmFuazogIiIsCiAgICAgICAgZGF0ZTogIiIsCiAgICAgICAgYW1vdW50OiAwLAogICAgICAgIHJlZmVyZW5jZV9ubzogIiIsCiAgICAgIH0sCiAgICAgIHVucmVxdWlyZWQ6IHsKICAgICAgICBwYXltZW50X2RldGFpbHM6IFtdLAogICAgICB9LAogICAgICB1cGxvYWRIYXNFcnJvcjogZmFsc2UsCiAgICB9OwogIH0sCiAgbW91bnRlZCgpIHsKICAgIGNvbnNvbGUubG9nKHRoaXMucGF5bWVudERldGFpbHMpOwogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgb25DbGlja0NhbGxiYWNrKHN0YXR1cykgewogICAgICBpZiAoc3RhdHVzKSB7CiAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCJzZXRMb2FkaW5nIiwgdHJ1ZSk7CiAgICAgICAgbGV0IGZvcm1EYXRhID0gdGhpcy5wYXltZW50RGV0YWlsczsKICAgICAgICBmb3JtRGF0YS5hcHBlbmQoInNvYSIsIHRoaXMuY3VycmVudFNvYU9iai5pZCk7CiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCJiYW5rIiwgdGhpcy5wYXltZW50X2RldGFpbHMuYmFuayk7CiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCJwYXltZW50X2RhdGUiLCB0aGlzLnBheW1lbnRfZGV0YWlscy5kYXRlKTsKICAgICAgICBmb3JtRGF0YS5hcHBlbmQoImFtb3VudCIsIHRoaXMucGF5bWVudF9kZXRhaWxzLmFtb3VudCk7CiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCJyZWZlcmVuY2Vfbm8iLCB0aGlzLnBheW1lbnRfZGV0YWlscy5yZWZlcmVuY2Vfbm8pOwogICAgICAgIGxldCB2YWxpZGF0ZSA9IHRoaXMudmFsaWRhdGVSZXF1aXJlZEZpZWxkcygpOwogICAgICAgIGlmICh2YWxpZGF0ZSkgewogICAgICAgICAgYXdhaXQgdGhpcy4kc3RvcmUuY29tbWl0KCJzZXRQYXltZW50RGV0YWlscyIsIGZvcm1EYXRhKTsKICAgICAgICAgIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJhZGRQYXltZW50RGV0YWlscyIpOwogICAgICAgIH0KICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoInNldExvYWRpbmciLCBmYWxzZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy4kbW9kYWwuaGlkZSgicGF5bWVudERldGFpbHNNb2RhbCIpOwogICAgICB9CiAgICB9LAogICAgdmFsaWRhdGVSZXF1aXJlZEZpZWxkcygpIHsKICAgICAgbGV0IHBheW1lbnRfZGV0YWlsc19lcnJvcnMgPSB7IGtleTogInBheW1lbnRfZGV0YWlscyIsIHZhbHVlOiB7fSB9OwogICAgICBsZXQgaXNQYXltZW50RGV0YWlsc0NsZWFuID0gdHJ1ZTsKICAgICAgZm9yIChsZXQga2V5IGluIHRoaXMucGF5bWVudF9kZXRhaWxzKSB7CiAgICAgICAgaWYgKCF0aGlzLnVucmVxdWlyZWQucGF5bWVudF9kZXRhaWxzLmluY2x1ZGVzKGtleSkpIHsKICAgICAgICAgIGlmICh0aGlzLnBheW1lbnRfZGV0YWlsc1trZXldID09PSAiIikgewogICAgICAgICAgICBwYXltZW50X2RldGFpbHNfZXJyb3JzLnZhbHVlW2Ake2tleX1gXSA9IFtdOwogICAgICAgICAgICBwYXltZW50X2RldGFpbHNfZXJyb3JzLnZhbHVlW2Ake2tleX1gXS5wdXNoKAogICAgICAgICAgICAgICJUaGlzIGZpZWxkIG1heSBub3QgYmUgYmxhbmsuIgogICAgICAgICAgICApOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoT2JqZWN0LmVudHJpZXMocGF5bWVudF9kZXRhaWxzX2Vycm9ycy52YWx1ZSkubGVuZ3RoID4gMCkgewogICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgic2V0U3RlcE9uZUVycm9ycyIsIHBheW1lbnRfZGV0YWlsc19lcnJvcnMpOwogICAgICAgIGlzUGF5bWVudERldGFpbHNDbGVhbiA9IGZhbHNlOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgic2V0U3RlcE9uZUVycm9ycyIsIHsKICAgICAgICAgIGtleTogInBheW1lbnREZXRhaWxzIiwKICAgICAgICAgIHZhbHVlOiB7fSwKICAgICAgICB9KTsKICAgICAgfQogICAgICBpZiAoIXRoaXMuaXNGaWxlVXBsb2FkZWQpIHsKICAgICAgICB0aGlzLnVwbG9hZEhhc0Vycm9yID0gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnVwbG9hZEhhc0Vycm9yID0gZmFsc2U7CiAgICAgIH0KICAgICAgaWYgKGlzUGF5bWVudERldGFpbHNDbGVhbiAmJiB0aGlzLmlzRmlsZVVwbG9hZGVkKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy4kc3dhbCh7CiAgICAgICAgICB0aXRsZTogIkZhaWxlZCEiLAogICAgICAgICAgdGV4dDogIlBsZWFzZSBmaXggdGhlIHZhbGlkYXRpb24gZXJyb3JzLiIsCiAgICAgICAgICBpY29uOiAiZXJyb3IiLAogICAgICAgIH0pOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["PaymentDetailsModal.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"PaymentDetailsModal.vue","sourceRoot":"src/components/payment","sourcesContent":["<template>\n  <div class=\"modal flex-center\">\n    <div class=\"meta-modal\">\n      <div class=\"meta-wrap\">\n        <div class=\"meta-modal-body flex-wrap\">\n          <h3 class=\"mb20\">Please enter the payment details below:</h3>\n          <div class=\"meta-input-group\">\n            <div class=\"meta-input-label mt10 mb10\">Bank Used to Pay</div>\n            <base-input\n              v-model=\"payment_details.bank\"\n              label=\"Enter bank name\"\n              name=\"bank\"\n              refs=\"payment_bank\"\n              type=\"text\"\n              class=\"mt40 input-field\"\n              :validationMessages=\"stepOneErrors.payment_details.bank\"\n            />\n          </div>\n          <div class=\"meta-input-group\">\n            <div class=\"meta-input-label mt10 mb10\">Date of Payment</div>\n            <base-date-picker\n              v-model=\"payment_details.date\"\n              class=\"mb15 input-field\"\n              :validationMessages=\"stepOneErrors.payment_details.date\"\n            />\n          </div>\n          <div class=\"flex-wrap meta-input-group\">\n            <div class=\"meta-input-label mt10 mb10\">Total Amount Paid</div>\n            <currency-input\n              label=\"Total Amount Paid\"\n              name=\"totalamount\"\n              refs=\"total_amount\"\n              type=\"text\"\n              :isAmount=\"true\"\n              class=\"mt40 w100 input-field amount-paid\"\n              placeholder=\"Enter total amount paid\"\n              v-model=\"payment_details.amount\"\n              :validationMessages=\"stepOneErrors.payment_details.amount\"\n            />\n          </div>\n          <div class=\"meta-input-group\">\n            <div class=\"meta-input-label mt10 mb10\">Reference No.</div>\n            <base-input\n              label=\"Enter reference no.\"\n              name=\"refrenceno\"\n              refs=\"reference_no\"\n              type=\"text\"\n              class=\"mt40 input-field\"\n              v-model=\"payment_details.reference_no\"\n              :validationMessages=\"stepOneErrors.payment_details.reference_no\"\n            />\n          </div>\n          <div class=\"meta-upload-div flex-wrap\">\n            <base-file-uploader\n              label=\"Upload proof of transaction:\"\n              name=\"payment_slip\"\n              fileLabel=\"paymentdetails\"\n              type=\"business\"\n              class=\"mt15 custom-upload\"\n              :isPaymentDetails=\"true\"\n              :hasError=\"uploadHasError\"\n            />\n          </div>\n        </div>\n        <div class=\"meta-buttons flex-wrap\">\n          <button class=\"modal-button agree\" @click=\"onClickCallback(true)\">\n            SUBMIT\n          </button>\n          <button class=\"modal-button cancel\" @click=\"onClickCallback(false)\">\n            CANCEL\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport BaseInput from \"@/components/forms/BaseInput\";\nimport BaseDatePicker from \"@/components/forms/BaseDatePicker\";\nimport BaseFileUploader from \"@/components/forms/BaseFileUploader\";\nimport ButtonBlock from \"@/components/ButtonBlock\";\nimport { mapGetters } from \"vuex\";\nexport default {\n  name: \"PaymentDetailsModal\",\n  components: {\n    BaseInput,\n    BaseDatePicker,\n    BaseFileUploader,\n    ButtonBlock,\n  },\n  computed: {\n    ...mapGetters([\n      \"paymentDetails\",\n      \"currentSoaObj\",\n      \"stepOneErrors\",\n      \"isFileUploaded\",\n    ]),\n  },\n  data() {\n    return {\n      payment_details: {\n        bank: \"\",\n        date: \"\",\n        amount: 0,\n        reference_no: \"\",\n      },\n      unrequired: {\n        payment_details: [],\n      },\n      uploadHasError: false,\n    };\n  },\n  mounted() {\n    console.log(this.paymentDetails);\n  },\n  methods: {\n    async onClickCallback(status) {\n      if (status) {\n        this.$store.commit(\"setLoading\", true);\n        let formData = this.paymentDetails;\n        formData.append(\"soa\", this.currentSoaObj.id);\n        formData.append(\"bank\", this.payment_details.bank);\n        formData.append(\"payment_date\", this.payment_details.date);\n        formData.append(\"amount\", this.payment_details.amount);\n        formData.append(\"reference_no\", this.payment_details.reference_no);\n        let validate = this.validateRequiredFields();\n        if (validate) {\n          await this.$store.commit(\"setPaymentDetails\", formData);\n          await this.$store.dispatch(\"addPaymentDetails\");\n        }\n        this.$store.commit(\"setLoading\", false);\n      } else {\n        this.$modal.hide(\"paymentDetailsModal\");\n      }\n    },\n    validateRequiredFields() {\n      let payment_details_errors = { key: \"payment_details\", value: {} };\n      let isPaymentDetailsClean = true;\n      for (let key in this.payment_details) {\n        if (!this.unrequired.payment_details.includes(key)) {\n          if (this.payment_details[key] === \"\") {\n            payment_details_errors.value[`${key}`] = [];\n            payment_details_errors.value[`${key}`].push(\n              \"This field may not be blank.\"\n            );\n          }\n        }\n      }\n      if (Object.entries(payment_details_errors.value).length > 0) {\n        this.$store.commit(\"setStepOneErrors\", payment_details_errors);\n        isPaymentDetailsClean = false;\n      } else {\n        this.$store.commit(\"setStepOneErrors\", {\n          key: \"paymentDetails\",\n          value: {},\n        });\n      }\n      if (!this.isFileUploaded) {\n        this.uploadHasError = true;\n      } else {\n        this.uploadHasError = false;\n      }\n      if (isPaymentDetailsClean && this.isFileUploaded) {\n        return true;\n      } else {\n        this.$swal({\n          title: \"Failed!\",\n          text: \"Please fix the validation errors.\",\n          icon: \"error\",\n        });\n        return false;\n      }\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.modal {\n  min-height: calc(100vh - 60px);\n  padding: 30px 0;\n  overflow-y: auto;\n  .meta-modal {\n    width: 100%;\n    max-width: 500px;\n    margin: 0 auto;\n    box-shadow: 0px 7px 20px rgba(0, 0, 0, 0.1);\n    border-radius: 15px;\n    background: #ffffff;\n    .meta-modal-body {\n      font-size: 18px;\n      font-family: Proxima Nova Rg;\n      line-height: 1.4;\n      padding: 50px 30px;\n      .meta-input-group {\n        width: calc(50% - 20px);\n        padding: 0 10px;\n        align-items: flex-start;\n        display: flex;\n        flex-wrap: wrap;\n        float: left;\n        .input-field {\n          width: 100%;\n        }\n      }\n      .meta-upload-div {\n        width: 100%;\n        padding: 0 10px;\n      }\n    }\n    .meta-buttons {\n      width: 100%;\n      button {\n        width: 50%;\n        float: left;\n        background-color: transparent;\n        border: 0;\n        padding: 20px 10px;\n        border-top: 1px solid #eee;\n        font-size: 15px;\n        font-weight: bold;\n        font-family: Proxima Nova Rg;\n        transition: 0.2s;\n        cursor: pointer;\n      }\n      button:focus {\n        outline: 0;\n      }\n      button.agree {\n        border-right: 1px solid #eee;\n        border-bottom-left-radius: 15px;\n      }\n      button.cancel {\n        border-bottom-right-radius: 15px;\n      }\n      button.agree:hover {\n        color: #fff;\n        background-color: #4791db;\n      }\n      button.cancel:hover {\n        color: #fff;\n        background-color: #f44336;\n      }\n    }\n  }\n}\n</style>"]}]}