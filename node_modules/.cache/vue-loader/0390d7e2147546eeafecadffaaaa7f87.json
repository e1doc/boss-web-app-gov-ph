{"remainingRequest":"/var/www/html/boss-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/var/www/html/boss-web/src/pages/MobileRedirectToEpp.vue?vue&type=script&lang=js&","dependencies":[{"path":"/var/www/html/boss-web/src/pages/MobileRedirectToEpp.vue","mtime":1651664677521},{"path":"/var/www/html/boss-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/var/www/html/boss-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/var/www/html/boss-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/var/www/html/boss-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmNvbnN0IGFwaV91cmwgPSBwcm9jZXNzLmVudi5WVUVfQVBQX0FQSV9VUkw7CmltcG9ydCB7IG1hcEdldHRlcnMgfSBmcm9tICJ2dWV4IjsKaW1wb3J0IG1kNSBmcm9tICJjcnlwdG8tanMvbWQ1IjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJNb2JpbGVSZWRpcmVjdFRvRXBwIiwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgcHJpbnRWaXNpYmxlOiBmYWxzZSwKICAgICAgaXNQYXltZW50OiB0cnVlLAogICAgICBzZWxlY3RlZFBheW1lbnQ6ICJsYW5kYmFuayIsCiAgICAgIGlzRmVhdHVyZUltcGxlbWVudGVkOiB0cnVlLAogICAgICBtZXJjaGFudENvZGU6ICIyMDIwMTAwMDE1IiwKICAgICAgbWVyY2hhbnRSZWZObzogIiIsCiAgICAgIHBhcnRpY3VsYXJzOiAiIiwKICAgICAgYW1vdW50OiAiIiwKICAgICAgcGF5b3JOYW1lOiAiIiwKICAgICAgcGF5b3JFbWFpbDogIiIsCiAgICAgIHJldHVyblVybE9rOiBhcGlfdXJsICsgIi9hcGkvcGF5bWVudC1zdWNjZXNzLyIsCiAgICAgIHJldHVyblVybEVycm9yOiBhcGlfdXJsICsgIi9hcGkvcGF5bWVudC1lcnJvci8iLAogICAgICBoYXNoOiAiIiwKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgLi4ubWFwR2V0dGVycyhbCiAgICAgICJwYXltZW50T3B0aW9uIiwKICAgICAgImN1cnJlbnRQYXltZW50VHlwZSIsCiAgICAgICJjdXJyZW50U29hT2JqIiwKICAgICAgInVzZXJEZXRhaWxzIiwKICAgIF0pLAogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuZ2V0RGF0YSgpOwogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgZ2V0RGF0YSgpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBpZCA9IHRoaXMuJHJvdXRlLnBhcmFtcy5pZDsKICAgICAgICBjb25zdCB0b2tlbiA9IHRoaXMuJHJvdXRlLnBhcmFtcy50b2tlbjsKICAgICAgICBjb25zdCB0eXBlID0gdGhpcy4kcm91dGUucGFyYW1zLnR5cGU7CgogICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGF4aW9zLmdldCgKICAgICAgICAgIGAke2FwaV91cmx9L2FwaS9kb3dubG9hZC1pbnZvaWNlLz9pZD0ke2lkfWAsCiAgICAgICAgICB7IGhlYWRlcnM6IHsgQXV0aG9yaXphdGlvbjogYGp3dCAke3Rva2VufWAgfSB9CiAgICAgICAgKTsKCiAgICAgICAgY29uc3Qgc29hID0gcmVzdWx0LmRhdGE7CiAgICAgICAgaWYgKHNvYSkgewogICAgICAgICAgYXdhaXQgdGhpcy4kc3RvcmUuY29tbWl0KCJzZXRDdXJyZW50U29hT2JqIiwgc29hKTsKICAgICAgICAgIGlmICh0eXBlID09PSAiYnVzaW5lc3MiKSB7CiAgICAgICAgICAgIGF3YWl0IHRoaXMuJHN0b3JlLmNvbW1pdCgKICAgICAgICAgICAgICAic2V0Q3VycmVudFNlbGVjdGVkQnVzaW5lc3MiLAogICAgICAgICAgICAgIHNvYS5idXNpbmVzc19hcHBsaWNhdGlvbgogICAgICAgICAgICApOwogICAgICAgICAgfQogICAgICAgICAgYXdhaXQgdGhpcy4kc3RvcmUuY29tbWl0KCJzZXRDdXJyZW50U29hVHlwZSIsIHR5cGUpOwogICAgICAgICAgYXdhaXQgdGhpcy5zZXR1cEZvcm1EYXRhKCk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBjb25zb2xlLmxvZyhlcnIpOwogICAgICB9CiAgICB9LAogICAgc2V0dXBGb3JtRGF0YSgpIHsKICAgICAgbGV0IGJ1c2luZXNzX2FwcGxpY2F0aW9uID0gdGhpcy5jdXJyZW50U29hT2JqLmJ1c2luZXNzX2FwcGxpY2F0aW9uOwogICAgICBsZXQgYnVpbGRpbmdfYXBwbGljYXRpb24gPSB0aGlzLmN1cnJlbnRTb2FPYmouYnVpbGRpbmdfYXBwbGljYXRpb247CiAgICAgIHRoaXMuYW1vdW50ID0gdGhpcy5jdXJyZW50U29hT2JqLmFtb3VudDsKICAgICAgdGhpcy5tZXJjaGFudFJlZk5vID0gdGhpcy5jdXJyZW50U29hT2JqLnJlZmVyZW5jZV9udW1iZXI7CiAgICAgIHRoaXMucGF5b3JOYW1lID0gYCR7dGhpcy51c2VyRGV0YWlscy5maXJzdF9uYW1lfSAke3RoaXMudXNlckRldGFpbHMubGFzdF9uYW1lfWA7CiAgICAgIHRoaXMucGF5b3JFbWFpbCA9IHRoaXMudXNlckRldGFpbHMuZW1haWw7CiAgICAgIGxldCBwYXltb2RlID0KICAgICAgICB0aGlzLmN1cnJlbnRTb2FPYmoucGF5bW9kZSA9PT0gIkEiCiAgICAgICAgICA/ICJBbm51YWxseSIKICAgICAgICAgIDogdGhpcy5jdXJyZW50U29hT2JqLnBheW1vZGUgPT09ICJTIgogICAgICAgICAgPyAiU2VtaS1Bbm51YWxseSIKICAgICAgICAgIDogIlF1YXJ0ZXJseSI7CiAgICAgIGlmICh0aGlzLmN1cnJlbnRTb2FPYmouYXBwbGljYXRpb25fdHlwZSA9PT0gImJ1c2luZXNzIikgewogICAgICAgIGNvbnN0IGJ1c2luZXNzTmFtZSA9CiAgICAgICAgICBidXNpbmVzc19hcHBsaWNhdGlvbi5idXNpbmVzc2RldGFpbHMubmFtZSAhPSAiIgogICAgICAgICAgICA/IGJ1c2luZXNzX2FwcGxpY2F0aW9uLmJ1c2luZXNzZGV0YWlscy5uYW1lCiAgICAgICAgICAgIDogYnVzaW5lc3NfYXBwbGljYXRpb24uYnVzaW5lc3NkZXRhaWxzLnRyYWRlX25hbWU7CiAgICAgICAgdGhpcy5wYXJ0aWN1bGFycyA9IGB0cmFuc2FjdGlvbl90eXBlPUJ1c2luZXNzIFRheDtBY2NvdW50IE5vLj0kewogICAgICAgICAgYnVzaW5lc3NfYXBwbGljYXRpb24uYWNjb3VudF9udW1iZXIKICAgICAgICB9O0J1c2luZXNzIE5hbWU9JHtidXNpbmVzc05hbWV9O1BheW1lbnQgTW9kZT0ke3BheW1vZGV9O1F1YXJ0ZXI9JHsKICAgICAgICAgIHBheW1vZGUgPT09ICJBbm51YWx5IiA/ICIxLTQiIDogdGhpcy5jdXJyZW50U29hT2JqLnF1YXJ0ZXIKICAgICAgICB9YDsKICAgICAgfSBlbHNlIHsKICAgICAgICBsZXQgYnVpbGRpbmdCYXNpY0luZm8gPSBidWlsZGluZ19hcHBsaWNhdGlvbi5idWlsZGluZ2Jhc2ljaW5mb3JtYXRpb247CiAgICAgICAgbGV0IGRlY2xhcmVkT3duZXIgPSBgJHtidWlsZGluZ0Jhc2ljSW5mby5vd25lcl9maXJzdF9uYW1lfSAke2J1aWxkaW5nQmFzaWNJbmZvLm93bmVyX21pZGRsZV9uYW1lfSAke2J1aWxkaW5nQmFzaWNJbmZvLm93bmVyX2xhc3RfbmFtZX1gOwogICAgICAgIHRoaXMucGFydGljdWxhcnMgPSBgdHJhbnNhY3Rpb25fdHlwZT1SZWFsIFByb3BlcnR5IFRheDtUYXggRGVjbGFyYXRpb249JHtidWlsZGluZ19hcHBsaWNhdGlvbi5idWlsZGluZ2RldGFpbHMudGF4X2RlY19ub307RGVjbGFyZWQgT3duZXI9JHtkZWNsYXJlZE93bmVyfTtQYXltZW50IE1vZGU9JHtwYXltb2RlfTtRdWFydGVyPSR7dGhpcy5jdXJyZW50U29hT2JqLnF1YXJ0ZXJ9O1RvdGFsIEFtb3VudD0ke3RoaXMuY3VycmVudFNvYU9iai5hbW91bnR9YDsKICAgICAgfQogICAgICB0aGlzLmhhc2ggPSB0aGlzLmdldEhhc2goKTsKCiAgICAgIHRoaXMuc3VibWl0KCk7CiAgICB9LAogICAgc3VibWl0KCkgewogICAgICB0aGlzLiRyZWZzLmZvcm0uc3VibWl0KCk7CiAgICAgIC8vIHdpbmRvdy5vcGVuKAogICAgICAvLyAgICJodHRwczovL2VwYXltZW50cG9ydGFsLmxhbmRiYW5rLmNvbS9wYXkxLnBocD9jb2RlPVNsbDFia1pSYTBwdFVtaHZhMnR6UkdaWFJXOUtMMUJGY1VobU4ySmhXVGhyVFcxUmNqZE1aemxuTkQwPSIsCiAgICAgIC8vICAgIl9ibGFuayIKICAgICAgLy8gKTsKICAgIH0sCiAgICBnZXRIYXNoKCkgewogICAgICBsZXQgYW1vdW50ID0gcGFyc2VGbG9hdCh0aGlzLmN1cnJlbnRTb2FPYmouYW1vdW50KS50b0ZpeGVkKDIpOwogICAgICBhbW91bnQgPSBhbW91bnQgKiAxMDA7CiAgICAgIHJldHVybiBtZDUoCiAgICAgICAgdGhpcy5tZXJjaGFudENvZGUgKyB0aGlzLm1lcmNoYW50UmVmTm8gKyBwYXJzZUludChNYXRoLnJvdW5kKGFtb3VudCkpCiAgICAgICkKICAgICAgICAudG9TdHJpbmcoKQogICAgICAgIC50b0xvd2VyQ2FzZSgpOwogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["MobileRedirectToEpp.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAuBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"MobileRedirectToEpp.vue","sourceRoot":"src/pages","sourcesContent":["<template>\n  <form\n    action=\"https://epaymentportal.landbank.com/\"\n    method=\"POST\"\n    target=\"_blank\"\n    @submit=\"submit\"\n    ref=\"form\"\n  >\n    <input type=\"hidden\" name=\"MerchantCode\" :value=\"merchantCode\" />\n    <input type=\"hidden\" name=\"MerchantRefNo\" :value=\"merchantRefNo\" />\n    <input type=\"hidden\" name=\"Particulars\" :value=\"particulars\" />\n\n    <input type=\"hidden\" name=\"Amount\" :value=\"amount\" />\n    <input type=\"hidden\" name=\"PayorName\" :value=\"payorName\" />\n    <input type=\"hidden\" name=\"PayorEmail\" :value=\"payorEmail\" />\n    <input type=\"hidden\" name=\"ReturnURLOK\" :value=\"returnUrlOk\" />\n\n    <input type=\"hidden\" name=\"ReturnURLError\" :value=\"returnUrlError\" />\n    <input type=\"hidden\" name=\"Hash\" :value=\"hash\" />\n  </form>\n</template>\n\n<script>\nimport axios from \"axios\";\nconst api_url = process.env.VUE_APP_API_URL;\nimport { mapGetters } from \"vuex\";\nimport md5 from \"crypto-js/md5\";\nexport default {\n  name: \"MobileRedirectToEpp\",\n  data() {\n    return {\n      printVisible: false,\n      isPayment: true,\n      selectedPayment: \"landbank\",\n      isFeatureImplemented: true,\n      merchantCode: \"2020100015\",\n      merchantRefNo: \"\",\n      particulars: \"\",\n      amount: \"\",\n      payorName: \"\",\n      payorEmail: \"\",\n      returnUrlOk: api_url + \"/api/payment-success/\",\n      returnUrlError: api_url + \"/api/payment-error/\",\n      hash: \"\",\n    };\n  },\n  computed: {\n    ...mapGetters([\n      \"paymentOption\",\n      \"currentPaymentType\",\n      \"currentSoaObj\",\n      \"userDetails\",\n    ]),\n  },\n  mounted() {\n    this.getData();\n  },\n  methods: {\n    async getData() {\n      try {\n        const id = this.$route.params.id;\n        const token = this.$route.params.token;\n        const type = this.$route.params.type;\n\n        const result = await axios.get(\n          `${api_url}/api/download-invoice/?id=${id}`,\n          { headers: { Authorization: `jwt ${token}` } }\n        );\n\n        const soa = result.data;\n        if (soa) {\n          await this.$store.commit(\"setCurrentSoaObj\", soa);\n          if (type === \"business\") {\n            await this.$store.commit(\n              \"setCurrentSelectedBusiness\",\n              soa.business_application\n            );\n          }\n          await this.$store.commit(\"setCurrentSoaType\", type);\n          await this.setupFormData();\n        }\n      } catch (err) {\n        console.log(err);\n      }\n    },\n    setupFormData() {\n      let business_application = this.currentSoaObj.business_application;\n      let building_application = this.currentSoaObj.building_application;\n      this.amount = this.currentSoaObj.amount;\n      this.merchantRefNo = this.currentSoaObj.reference_number;\n      this.payorName = `${this.userDetails.first_name} ${this.userDetails.last_name}`;\n      this.payorEmail = this.userDetails.email;\n      let paymode =\n        this.currentSoaObj.paymode === \"A\"\n          ? \"Annually\"\n          : this.currentSoaObj.paymode === \"S\"\n          ? \"Semi-Annually\"\n          : \"Quarterly\";\n      if (this.currentSoaObj.application_type === \"business\") {\n        const businessName =\n          business_application.businessdetails.name != \"\"\n            ? business_application.businessdetails.name\n            : business_application.businessdetails.trade_name;\n        this.particulars = `transaction_type=Business Tax;Account No.=${\n          business_application.account_number\n        };Business Name=${businessName};Payment Mode=${paymode};Quarter=${\n          paymode === \"Annualy\" ? \"1-4\" : this.currentSoaObj.quarter\n        }`;\n      } else {\n        let buildingBasicInfo = building_application.buildingbasicinformation;\n        let declaredOwner = `${buildingBasicInfo.owner_first_name} ${buildingBasicInfo.owner_middle_name} ${buildingBasicInfo.owner_last_name}`;\n        this.particulars = `transaction_type=Real Property Tax;Tax Declaration=${building_application.buildingdetails.tax_dec_no};Declared Owner=${declaredOwner};Payment Mode=${paymode};Quarter=${this.currentSoaObj.quarter};Total Amount=${this.currentSoaObj.amount}`;\n      }\n      this.hash = this.getHash();\n\n      this.submit();\n    },\n    submit() {\n      this.$refs.form.submit();\n      // window.open(\n      //   \"https://epaymentportal.landbank.com/pay1.php?code=Sll1bkZRa0ptUmhva2tzRGZXRW9KL1BFcUhmN2JhWThrTW1RcjdMZzlnND0=\",\n      //   \"_blank\"\n      // );\n    },\n    getHash() {\n      let amount = parseFloat(this.currentSoaObj.amount).toFixed(2);\n      amount = amount * 100;\n      return md5(\n        this.merchantCode + this.merchantRefNo + parseInt(Math.round(amount))\n      )\n        .toString()\n        .toLowerCase();\n    },\n  },\n};\n</script>\n\n<style>\n</style>"]}]}