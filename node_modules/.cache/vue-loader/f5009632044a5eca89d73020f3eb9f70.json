{"remainingRequest":"/var/www/html/boss-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/var/www/html/boss-web/src/pages/AddAppointment.vue?vue&type=script&lang=js&","dependencies":[{"path":"/var/www/html/boss-web/src/pages/AddAppointment.vue","mtime":1606242937935},{"path":"/var/www/html/boss-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/var/www/html/boss-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/var/www/html/boss-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/var/www/html/boss-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBGdWxsQ2FsZW5kYXIgZnJvbSAiQGZ1bGxjYWxlbmRhci92dWUiOwppbXBvcnQgZGF5R3JpZFBsdWdpbiBmcm9tICJAZnVsbGNhbGVuZGFyL2RheWdyaWQiOwppbXBvcnQgaW50ZXJhY3Rpb25QbHVnaW4gZnJvbSAiQGZ1bGxjYWxlbmRhci9pbnRlcmFjdGlvbiI7CmltcG9ydCBBcHBvaW50bWVudEZvcm0gZnJvbSAiQC9jb21wb25lbnRzL2Zvcm1zL0FwcG9pbnRtZW50Rm9ybSI7CmltcG9ydCBtb21lbnQgZnJvbSAibW9tZW50LXRpbWV6b25lIjsKaW1wb3J0IHsgbWFwR2V0dGVycyB9IGZyb20gInZ1ZXgiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkFkZEFwcG9pbnRtZW50IiwKICBjb21wb25lbnRzOiB7CiAgICBGdWxsQ2FsZW5kYXIsCiAgICBBcHBvaW50bWVudEZvcm0sCiAgfSwKICBjb21wdXRlZDogewogICAgLi4ubWFwR2V0dGVycyhbImFwcG9pbnRtZW50cyIsICJhcHBvaW50bWVudExpbWl0cyJdKSwKICB9LAogIHdhdGNoOiB7CiAgICBhcHBvaW50bWVudHM6IHsKICAgICAgZGVlcDogdHJ1ZSwKICAgICAgaGFuZGxlcihzdGF0dXMpIHsKICAgICAgICB0aGlzLmNhbGVuZGFyT3B0aW9ucy5ldmVudHMgPSBbXTsKICAgICAgICB0aGlzLnNldFVwQXBwb2ludG1lbnRzKCk7CiAgICAgIH0sCiAgICB9LAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGV2ZW50czogW10sCgogICAgICBjYWxlbmRhck9wdGlvbnM6IHsKICAgICAgICBwbHVnaW5zOiBbZGF5R3JpZFBsdWdpbiwgaW50ZXJhY3Rpb25QbHVnaW5dLAogICAgICAgIGluaXRpYWxWaWV3OiAiZGF5R3JpZE1vbnRoIiwKICAgICAgICB3ZWVrZW5kczogZmFsc2UsCiAgICAgICAgc2VsZWN0YWJsZTogdHJ1ZSwKICAgICAgICBldmVudHM6IFtdLAogICAgICAgIGRhdGVDbGljazogdGhpcy5oYW5kbGVEYXRlQ2xpY2ssCiAgICAgICAgZGF5TWF4RXZlbnRzOiB0cnVlLAogICAgICAgIHZpZXdzOiB7CiAgICAgICAgICBkYXlHcmlkOiB7CiAgICAgICAgICAgIGRheVJlbmRlcjogZnVuY3Rpb24oZGF0ZSwgY2VsbCkgewogICAgICAgICAgICAgIGlmIChkYXRlIDwgbW9tZW50KG5ldyBEYXRlKERhdGUubm93KCkpKS5lbmRPZigiZGF5IikpIHsKICAgICAgICAgICAgICAgICQoY2VsbCkuYWRkQ2xhc3MoImRpc2FibGVkIik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICBkYXlNYXhFdmVudHM6IDIsIC8vIGFkanVzdCB0byA2IG9ubHkgZm9yIHRpbWVHcmlkV2Vlay90aW1lR3JpZERheQogICAgICAgICAgfSwKICAgICAgICB9LAogICAgICAgIGN1c3RvbUJ1dHRvbnM6IHsKICAgICAgICAgIHByZXY6IHsKICAgICAgICAgICAgLy8gdGhpcyBvdmVycmlkZXMgdGhlIHByZXYgYnV0dG9uCiAgICAgICAgICAgIHRleHQ6ICJQUkVWIiwKICAgICAgICAgICAgY2xpY2s6ICgpID0+IHsKICAgICAgICAgICAgICBsZXQgY2FsZW5kYXJBcGkgPSB0aGlzLiRyZWZzLmFwcG9pbnRtZW50Q2FsZW5kYXIuZ2V0QXBpKCk7CiAgICAgICAgICAgICAgY2FsZW5kYXJBcGkucHJldigpOwogICAgICAgICAgICAgIHRoaXMuZ2V0TGltaXRzKCk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICB9LAogICAgICAgICAgbmV4dDogewogICAgICAgICAgICAvLyB0aGlzIG92ZXJyaWRlcyB0aGUgbmV4dCBidXR0b24KICAgICAgICAgICAgdGV4dDogIk5FWFQiLAogICAgICAgICAgICBjbGljazogKCkgPT4gewogICAgICAgICAgICAgIGxldCBjYWxlbmRhckFwaSA9IHRoaXMuJHJlZnMuYXBwb2ludG1lbnRDYWxlbmRhci5nZXRBcGkoKTsKICAgICAgICAgICAgICBjYWxlbmRhckFwaS5uZXh0KCk7CiAgICAgICAgICAgICAgdGhpcy5nZXRMaW1pdHMoKTsKICAgICAgICAgICAgfSwKICAgICAgICAgIH0sCiAgICAgICAgfSwKICAgICAgICBoZWFkZXJUb29sYmFyOiB7CiAgICAgICAgICBsZWZ0OiAidGl0bGUiLAogICAgICAgICAgcmlnaHQ6ICJ0b2RheSwgcHJldixuZXh0IiwKICAgICAgICB9LAogICAgICB9LAogICAgfTsKICB9LAogIG1vdW50ZWQoKSB7CiAgICAvLyB0aGlzLnNldFVwQXBwb2ludG1lbnRzKCk7CiAgICB0aGlzLmdldExpbWl0cygpOwogICAgdGhpcy4kc3RvcmUuY29tbWl0KCJzZXRDdXJyZW50UGF5bWVudFR5cGUiLCAibGFuZGJhbmsiKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGFzeW5jIGdldExpbWl0cygpIHsKICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCJzZXRMb2FkaW5nIiwgdHJ1ZSk7CiAgICAgIGxldCBjYWxlbmRhckFwaSA9IHRoaXMuJHJlZnMuYXBwb2ludG1lbnRDYWxlbmRhci5nZXRBcGkoKTsKICAgICAgbGV0IGN1cnJlbnREYXRlID0gY2FsZW5kYXJBcGkuZ2V0RGF0ZSgpOwogICAgICBsZXQgbW9udGggPSBjdXJyZW50RGF0ZS5nZXRNb250aCgpOwogICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgiZ2V0VXNlckFwcG9pbnRtZW50TGltaXRzIiwgbW9udGgpOwogICAgICB0aGlzLiRzdG9yZS5jb21taXQoInNldExvYWRpbmciLCBmYWxzZSk7CiAgICAgIGlmICh0aGlzLmFwcG9pbnRtZW50TGltaXRzLmxlbmd0aCA+IDApIHsKICAgICAgICB0aGlzLmNhbGVuZGFyT3B0aW9ucy5ldmVudHMgPSBbXTsKICAgICAgICBsZXQgY3VycmVudERhdGUgPSBtb21lbnQudHoobmV3IERhdGUoRGF0ZS5ub3coKSksICJBc2lhL01hbmlsYSIpOwoKICAgICAgICB0aGlzLmFwcG9pbnRtZW50TGltaXRzLmZvckVhY2goKGl0ZW0pID0+IHsKICAgICAgICAgIGxldCBkYXRlID0gbW9tZW50LnR6KGl0ZW0uZGF0ZSwgIkFzaWEvTWFuaWxhIik7CiAgICAgICAgICBpZiAoZGF0ZS5pc0FmdGVyKGN1cnJlbnREYXRlLmVuZE9mKCJkYXkiKSkpIHsKICAgICAgICAgICAgbGV0IHJlbWFpbmluZ19ldmVudCA9IHsKICAgICAgICAgICAgICBpZDogaXRlbS5pZCwKICAgICAgICAgICAgICB0aXRsZToKICAgICAgICAgICAgICAgIGl0ZW0uYmF0Y2ggPT09ICJiYXRjaF8xIgogICAgICAgICAgICAgICAgICA/IGBCYXRjaCAxOiAke2l0ZW0ucmVtYWluaW5nfSBzbG90c2AKICAgICAgICAgICAgICAgICAgOiBgQmF0Y2ggMjogJHtpdGVtLnJlbWFpbmluZ30gc2xvdHNgLAogICAgICAgICAgICAgIHN0YXJ0OiBpdGVtLmRhdGUsCiAgICAgICAgICAgICAgYWxsRGF5OiB0cnVlLAogICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogaXRlbS5yZW1haW5pbmcgPCAxID8gIiNlMjNhMzYiIDogIiMyZWNjNzEiLAogICAgICAgICAgICAgIGJvcmRlckNvbG9yOiBpdGVtLnJlbWFpbmluZyA8IDEgPyAiI2UyM2EzNiIgOiAiIzJlY2M3MSIsCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHRoaXMuY2FsZW5kYXJPcHRpb25zLmV2ZW50cy5wdXNoKHJlbWFpbmluZ19ldmVudCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBoYW5kbGVEYXRlQ2xpY2soaW5mbykgewogICAgICBsZXQgZGF0ZSA9IG1vbWVudChpbmZvLmRhdGUpLmZvcm1hdCgpOwogICAgICBsZXQgY3VycmVudERhdGUgPSBtb21lbnQudHoobmV3IERhdGUoRGF0ZS5ub3coKSksICJBc2lhL01hbmlsYSIpOwogICAgICBsZXQgc2VsZWN0ZWREYXRlID0gbW9tZW50LnR6KGluZm8uZGF0ZSwgIkFzaWEvTWFuaWxhIik7CiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgic2V0Q3VycmVudERhdGUiLCBkYXRlKTsKICAgICAgdGhpcy4kbW9kYWwuc2hvdygiYXBwb2ludG1lbnRNb2RhbCIpOwogICAgfSwKICAgIHNldFVwQXBwb2ludG1lbnRzKCkgewogICAgICBpZiAodGhpcy5hcHBvaW50bWVudHMubGVuZ3RoID4gMCkgewogICAgICAgIHRoaXMuYXBwb2ludG1lbnRzLmZvckVhY2goKGl0ZW0pID0+IHsKICAgICAgICAgIGxldCBldmVudCA9IHsKICAgICAgICAgICAgaWQ6IGl0ZW0uaWQsCiAgICAgICAgICAgIHRpdGxlOiBgJHtpdGVtLnRpdGxlfWAsCiAgICAgICAgICAgIHN0YXJ0OiBtb21lbnQKICAgICAgICAgICAgICAudHooaXRlbS5hcHBvaW50bWVudF9kYXRlLCAiQXNpYS9NYW5pbGEiKQogICAgICAgICAgICAgIC5mb3JtYXQoIllZWVktTU0tREQiKSwKICAgICAgICAgIH07CiAgICAgICAgICB0aGlzLmNhbGVuZGFyT3B0aW9ucy5ldmVudHMucHVzaChldmVudCk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["AddAppointment.vue"],"names":[],"mappings":";;;;;;;;;;;;;;AAcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AddAppointment.vue","sourceRoot":"src/pages","sourcesContent":["<template>\n  <section>\n    <modal name=\"appointmentModal\" width=\"50%\" height=\"auto\" :adaptive=\"true\"\n      ><appointment-form\n    /></modal>\n    <div class=\"container\">\n      <div class=\"meta-calendar-container\">\n        <FullCalendar :options=\"calendarOptions\" ref=\"appointmentCalendar\" />\n      </div>\n    </div>\n  </section>\n</template>\n\n<script>\nimport FullCalendar from \"@fullcalendar/vue\";\nimport dayGridPlugin from \"@fullcalendar/daygrid\";\nimport interactionPlugin from \"@fullcalendar/interaction\";\nimport AppointmentForm from \"@/components/forms/AppointmentForm\";\nimport moment from \"moment-timezone\";\nimport { mapGetters } from \"vuex\";\nexport default {\n  name: \"AddAppointment\",\n  components: {\n    FullCalendar,\n    AppointmentForm,\n  },\n  computed: {\n    ...mapGetters([\"appointments\", \"appointmentLimits\"]),\n  },\n  watch: {\n    appointments: {\n      deep: true,\n      handler(status) {\n        this.calendarOptions.events = [];\n        this.setUpAppointments();\n      },\n    },\n  },\n  data() {\n    return {\n      events: [],\n\n      calendarOptions: {\n        plugins: [dayGridPlugin, interactionPlugin],\n        initialView: \"dayGridMonth\",\n        weekends: false,\n        selectable: true,\n        events: [],\n        dateClick: this.handleDateClick,\n        dayMaxEvents: true,\n        views: {\n          dayGrid: {\n            dayRender: function(date, cell) {\n              if (date < moment(new Date(Date.now())).endOf(\"day\")) {\n                $(cell).addClass(\"disabled\");\n              }\n            },\n            dayMaxEvents: 2, // adjust to 6 only for timeGridWeek/timeGridDay\n          },\n        },\n        customButtons: {\n          prev: {\n            // this overrides the prev button\n            text: \"PREV\",\n            click: () => {\n              let calendarApi = this.$refs.appointmentCalendar.getApi();\n              calendarApi.prev();\n              this.getLimits();\n            },\n          },\n          next: {\n            // this overrides the next button\n            text: \"NEXT\",\n            click: () => {\n              let calendarApi = this.$refs.appointmentCalendar.getApi();\n              calendarApi.next();\n              this.getLimits();\n            },\n          },\n        },\n        headerToolbar: {\n          left: \"title\",\n          right: \"today, prev,next\",\n        },\n      },\n    };\n  },\n  mounted() {\n    // this.setUpAppointments();\n    this.getLimits();\n    this.$store.commit(\"setCurrentPaymentType\", \"landbank\");\n  },\n  methods: {\n    async getLimits() {\n      this.$store.commit(\"setLoading\", true);\n      let calendarApi = this.$refs.appointmentCalendar.getApi();\n      let currentDate = calendarApi.getDate();\n      let month = currentDate.getMonth();\n      await this.$store.dispatch(\"getUserAppointmentLimits\", month);\n      this.$store.commit(\"setLoading\", false);\n      if (this.appointmentLimits.length > 0) {\n        this.calendarOptions.events = [];\n        let currentDate = moment.tz(new Date(Date.now()), \"Asia/Manila\");\n\n        this.appointmentLimits.forEach((item) => {\n          let date = moment.tz(item.date, \"Asia/Manila\");\n          if (date.isAfter(currentDate.endOf(\"day\"))) {\n            let remaining_event = {\n              id: item.id,\n              title:\n                item.batch === \"batch_1\"\n                  ? `Batch 1: ${item.remaining} slots`\n                  : `Batch 2: ${item.remaining} slots`,\n              start: item.date,\n              allDay: true,\n              backgroundColor: item.remaining < 1 ? \"#e23a36\" : \"#2ecc71\",\n              borderColor: item.remaining < 1 ? \"#e23a36\" : \"#2ecc71\",\n            };\n            this.calendarOptions.events.push(remaining_event);\n          }\n        });\n      }\n    },\n    handleDateClick(info) {\n      let date = moment(info.date).format();\n      let currentDate = moment.tz(new Date(Date.now()), \"Asia/Manila\");\n      let selectedDate = moment.tz(info.date, \"Asia/Manila\");\n      this.$store.commit(\"setCurrentDate\", date);\n      this.$modal.show(\"appointmentModal\");\n    },\n    setUpAppointments() {\n      if (this.appointments.length > 0) {\n        this.appointments.forEach((item) => {\n          let event = {\n            id: item.id,\n            title: `${item.title}`,\n            start: moment\n              .tz(item.appointment_date, \"Asia/Manila\")\n              .format(\"YYYY-MM-DD\"),\n          };\n          this.calendarOptions.events.push(event);\n        });\n      }\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.meta-calendar-container {\n  padding: 25px 15px;\n}\n</style>\n"]}]}